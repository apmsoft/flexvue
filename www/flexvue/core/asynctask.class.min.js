"use strict";export default class AsyncTask{async doGet(e,t,n={},o={}){let r=e.length,a=e.lastIndexOf("."),s=e.substring(a,r).toLowerCase();if(".json"==s&&/^file:\/\/\//.test(location.href))return new Promise((n,o)=>{this.importPluginjQeury(function(){$.ajax({method:"GET",url:e,data:t,cache:!1,crossOrigin:!0,dataType:"json",beforeSend:function(e){}}).done(function(e){n(e)}).fail(function(e,t,n){var o=t+", "+n;throw new Error(o)})})});{let r=e;if(Object.keys(t).length>0){let e=Object.entries(t).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&");r=`${r}?${e}`}Log.d("doGet --> "+r);let a=o||{"Content-Type":"application/json"},s={method:"GET",mode:"no-cors",cache:config.cache,headers:a};s=Object.assign(s,n);const i=await fetch(r,s);if(i.ok)return await i.json();throw new Error(i.status)}}async doPost(e,t,n={},o={}){let r=e.length,a=e.lastIndexOf("."),s=e.substring(a,r).toLowerCase();if(".json"==s&&/^file:\/\/\//.test(location.href))return new Promise((n,o)=>{this.importPluginjQeury(function(){$.ajax({method:"POST",url:e,data:t,cache:!1,crossOrigin:!0,dataType:"json",beforeSend:function(e){}}).done(function(e){n(e)}).fail(function(e,t,n){var o=t+", "+n;throw new Error(o)})})});{let r=e,a=o||{"Content-Type":"application/json"},s={method:void 0!==t.id&&null!==t.id?"PUT":"POST",mode:"no-cors",cache:"no-cache",headers:a,body:JSON.stringify(t)};s=Object.assign(s,n),Log.d(r);const i=await fetch(r,s);if(i.ok)return await i.json();throw new Error(i.status)}}importPluginjQeury(e){if(null===document.querySelector('[src="flexvue/plugins/jquery/ajax.min.js"]')){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.src="flexvue/plugins/jquery/ajax.min.js",t.appendChild(n),n.onload=function(){e()}}else e()}async doImport(e){return Log.d("doImport : "+e),await import(e).then(e=>e)}async doImportCss(e){if(Log.d("doImportCss : "+e),null===document.querySelector(`[href="${e}"]`))return Log.d("run link import css"),await document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",`<link rel="stylesheet" href="${e}" />`)}}