"use strict";export default class ScrollAgent{constructor(e){this.TAG="ScrollAgent",this.channel=e,this.scrollerVertical=null,this.scrollerHorizontal=null,this.keys={37:1,38:1,39:1,40:1},this.supportsPassive=!1,this.wheelOpt=!1,this.wheelEvent="mousewheel",this.floatEl=null,this.floatElScrollPos=500}addFloatListener(e,t,l){const s=this;this.floatEl=document.querySelector(e),this.floatEl&&(Log.d(`${this.TAG} :: addFloatListener ----->`,"elId : "+e,"pos : "+t,"<---------//"),s.floatElScrollPos=t||500,Handler.post(function(){s.floatEl.classList.contains("hidden")||s.floatEl.classList.add("hidden")},1),"function"==typeof l&&l(this.floatEl))}addScrollListener(e,t){Log.d(`${this.TAG} :: addScrollListener ----->`,"mode : "+e,"channel : "+this.channel,"scrollTarget : "+t,"<---------//"),"vertical"==e?this.startVertical(t):"horizontal"==e&&this.startHorizontal(t)}startVertical(e){Log.d(`${this.TAG} :: startVertical ----->`);const t=this;if(this.scrollerVertical=document.querySelector(e),this.scrollerVertical){this.scrollerVertical.addEventListener("scroll",function(e){let l=this.scrollTop;ScrollObserver._setPos(t.channel,l),t.floatEl&&(l<t.floatElScrollPos?t.floatEl.classList.contains("hidden")||t.floatEl.classList.add("hidden"):t.floatEl.classList.contains("hidden")&&t.floatEl.classList.remove("hidden"))});try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t.supportsPassive=!0}}))}catch(e){}t.wheelOpt=!!t.supportsPassive&&{passive:!1},t.wheelEvent="onwheel"in document.createElement("div")?"wheel":"mousewheel"}}startHorizontal(e){Log.d(`${this.TAG} :: startHorizontal ----->`);const t=this;t.scrollerHorizontal=document.querySelector(`${e}`),t.scrollerHorizontal&&t.scrollerHorizontal.addEventListener("scroll",function(e){ScrollObserver._setPos(t.channel,this.scrollLeft)})}getPos(){let e=0;try{e=ScrollObserver._getPos(this.channel),Log.d(`${this.TAG} :: getPos ----->`,"pos : "+e,"<---------//")}catch(e){Log.d(e)}return e}resetPos(){Log.d(`${this.TAG} :: resetChannelTopPos ----->`,"channel : "+this.channel+", position : 0","<---------//"),ScrollObserver._setPos(this.channel,0)}scrollTo(e,t=null){Log.d(`${this.TAG} :: scrollTo`);const l=this,s=t||0;Handler.post(function(){l.scrollerVertical&&l.scrollerVertical.scrollTo(e)},s)}scrollToLeft(e){Log.d(`${this.TAG} :: scrollLeft`),this.scrollerHorizontal&&this.scrollerHorizontal.scrollTo(e)}scrollToBottom(e=null){const t=this,l=e||0;t.scrollerVertical&&Handler.post(function(){const e=t.scrollerVertical.scrollHeight;t.scrollerVertical.scrollTo({top:e})},l)}preventDefault(e){try{e.stopImmediatePropagation(),e.preventDefault()}catch(e){}}preventDefaultForScrollKeys(e){if(this.keys[e.keyCode])return this.preventDefault(e),!1}disableScroll(){Log.d(`${this.TAG} :: disableScroll`),this.scrollerVertical&&(this.scrollerVertical.addEventListener("DOMMouseScroll",this.preventDefault,!1),this.scrollerVertical.addEventListener(this.wheelEvent,this.preventDefault,this.wheelOpt),this.scrollerVertical.addEventListener("touchmove",this.preventDefault,!1),this.scrollerVertical.addEventListener("keydown",this.preventDefaultForScrollKeys,!1))}enableScroll(){Log.d(`${this.TAG} :: enableScroll`),this.scrollerVertical&&(this.scrollerVertical.removeEventListener("DOMMouseScroll",this.preventDefault,!1),this.scrollerVertical.removeEventListener(this.wheelEvent,this.preventDefault,this.wheelOpt),this.scrollerVertical.removeEventListener("touchmove",this.preventDefault),this.scrollerVertical.removeEventListener("keydown",this.preventDefaultForScrollKeys,!1))}}