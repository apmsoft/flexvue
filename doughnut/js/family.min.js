function onReady(e,i,o){UrlUtil.initialize(UrlUtil.getURL2JSON()),UrlUtil.pushState("family","",app.service_root_dir),ProgressBar.initialize(""),app.initialize({}),i.extend(Activity,{onCreate:function(){(void 0!==window.android||window.webkit&&window.webkit.messageHandlers.getSharedPreferences)&&(isMobile.Android()?window.android.getSharedPreferences("callbackGetSharedPreferences"):isMobile.iOS()&&webkit.messageHandlers.getSharedPreferences.postMessage("callbackGetSharedPreferences"))},onCreateView:function(){var o=this;app.language="ko"!=device_info.lang?device_info.lang:"",Runnable(function(){app.parserResource("/values/sysmsg",function(e){i.extend(app.lang,e)}),app.parserResource("/layout/family",function(e){i.extend(app.docs,e),o.doList()})}),e("#myModal_btn_close").on("click",function(){history.go(-1)}),e("#left_back_button, #left_title").on("click",function(){history.go(-1)}),e("#btn_bottom_close, #bottom_title").on("click",function(){history.go(-1)}),e("#right_back_button, #right_title").on("click",function(){history.go(-1)}),e("#rightside_back_button, #rightside_title").on("click",function(){history.go(-1)})},doList:function(){var o=this,s=app.docs.family.list,n=(Panel.onStart(s),userinfo);i.extend(n,{cache:!1}),i.extend(n,device_info),DocAsyncTask.doGetContents(s,n,{success:function(s,n){e("#left_docs_contents").html(s).promise().done(function(){"a"==n.msg[0].sex&&o.doEdit(n.msg[0].fid,function(){o.doList()}),e(".family-row").on("click",function(){var s=e(this).data("fid"),t=parseInt(s)-1;if(e(this).animateCss("bounce"),"a"==n.msg[t].sex)o.doEdit(s,function(){var e=n.msg[t].sex,o="f"==e?"images/nopimg_f.png":"images/nopimg_m.png";i.isUndefined(n.msg[t].profile_image)||""==n.msg[t].profile_image||(o=app.host_url+n.msg[t].profile_image),userinfo.profile_image=o,userinfo.fid=""+s,userinfo.nickname=n.msg[t].nickname,setSharedPreferences()});else{var r=n.msg[t].sex,a="f"==r?"images/nopimg_f.png":"images/nopimg_m.png";i.isUndefined(n.msg[t].profile_image)||""==n.msg[t].profile_image||(a=app.host_url+n.msg[t].profile_image),userinfo.profile_image=a,userinfo.fid=""+s,userinfo.nickname=n.msg[t].nickname,setSharedPreferences()}}),e(".family-edit").on("click",function(){var i=e(this).data("fid");o.doEdit(i,function(){o.doList()})}),e(".family-add-button").on("click",function(){var i=e(this).data("fid");o.doPost(i,function(){o.doList()})}),userinfo.authtoken=n.authtoken})},fail:function(e){ProgressBar.close_progress(),alert(e.msg)}})},doPost:function(o,s){ProgressBar.show_progress();var n=app.docs.family.post,t=Panel.onStart(n),r=userinfo;i.extend(r,{cache:!1,fid:o}),UrlUtil.pushUrlParams({mode:"post",fid:o}),UrlUtil.pushState("fimailPost","",app.service_root_dir+"?"+e.param(UrlUtil._url_params)),DocAsyncTask.doGetContents(n,r,{success:function(o,n){e(t.id+"_docs_contents").html(o).promise().done(function(){e(".btn-sex").on("click",function(){var i=e(this).data("sex");e("#sex").val(i),"f"==i?(e('button[data-sex="m"]').removeClass("btn-dark active").addClass("btn-outline-dark"),e('button[data-sex="f"]').addClass("btn-dark active")):"m"==i&&(e('button[data-sex="f"]').removeClass("btn-dark active").addClass("btn-outline-dark"),e('button[data-sex="m"]').addClass("btn-dark active"))}),DocAsyncTask.doSubmit("#theFamilyPostForm",function(o){var n=userinfo;i.extend(n,o),DocAsyncTask.doPostMessage(app.src+"/family/insert",n,{success:function(e){ProgressBar.close_progress(),history.go(-1),!i.isNull(s)&&i.isFunction(s)&&s()},fail:function(o){ProgressBar.close_progress(),void 0!==window.android?isMobile.Android()&&window.android.showToast(o.msg,"short","center"):alert(o.msg),i.isUndefined(o.fieldname)||e(t.id+"_docs_contents #theFamilyEditForm #"+o.fieldname).focus()}})}),ProgressBar.close_progress()})},fail:function(e){ProgressBar.close_progress(),void 0!==window.android?isMobile.Android()&&window.android.showToast(e.msg,"short","center"):alert(e.msg)}})},doEdit:function(o,s){var n=this;ProgressBar.show_progress();var t=app.docs.family.edit,r=Panel.onStart(t),a=userinfo;i.extend(a,{cache:!1,fid:o}),UrlUtil.pushUrlParams({mode:"edit",fid:o}),UrlUtil.pushState("fimailEdit","",app.service_root_dir+"?"+e.param(UrlUtil._url_params)),DocAsyncTask.doGetContents(t,a,{success:function(t,a){e(r.id+"_docs_contents").html(t).promise().done(function(){e("#myprofile_image").on("click",function(){n.doEditImage(o,function(){history.go(-1),!i.isNull(s)&&i.isFunction(s)&&s()})}),e(".btn-sex").on("click",function(){var i=e(this).data("sex");e("#sex").val(i),"f"==i?(e('button[data-sex="m"]').removeClass("btn-dark active").addClass("btn-outline-dark"),e('button[data-sex="f"]').addClass("btn-dark active")):"m"==i&&(e('button[data-sex="f"]').removeClass("btn-dark active").addClass("btn-outline-dark"),e('button[data-sex="m"]').addClass("btn-dark active"))}),DocAsyncTask.doSubmit("#theFamilyEditForm",function(o){var n=userinfo;i.extend(n,o),DocAsyncTask.doPostMessage(app.src+"/family/update",n,{success:function(e){ProgressBar.close_progress(),history.go(-1),!i.isNull(s)&&i.isFunction(s)&&s()},fail:function(o){ProgressBar.close_progress(),void 0!==window.android?isMobile.Android()&&window.android.showToast(o.msg,"short","center"):alert(o.msg),i.isUndefined(o.fieldname)||e(r.id+"_docs_contents #theFamilyEditForm #"+o.fieldname).focus()}})}),ProgressBar.close_progress()})},fail:function(e){ProgressBar.close_progress(),void 0!==window.android?isMobile.Android()&&window.android.showToast(e.msg,"short","center"):alert(e.msg)}})},doEditImage:function(o,s){ProgressBar.show_progress();var n=app.docs.family.image,t=Panel.onStart(n),r={doc_id:"member/image",usertoken:userinfo.usertoken,userid:userinfo.userid,fid:o};UrlUtil.pushState("profileeditimage","",app.service_root_dir+"?"+e.param({mode:"membereditimage"})),DocAsyncTask.doGetContents(n,r,{success:function(n,r){e(t.id+"_docs_contents").html(n).promise().done(function(){DocAsyncTask.doSubmit("#theEditImageForm",function(n){var t={doc_id:"member/image_update",usertoken:userinfo.usertoken,userid:userinfo.userid,fid:o};i.extend(t,n),DocAsyncTask.doPostMessage(app.src+"/document/stack",t,{success:function(e){ProgressBar.close_progress(),history.go(-1),!i.isNull(s)&&i.isFunction(s)&&s()},fail:function(o){ProgressBar.close_progress(),void 0!==window.android?isMobile.Android()&&window.android.showToast(o.msg,"short","center"):alert(o.msg),i.isUndefined(o.fieldname)||e("#"+o.fieldname).focus()}})}),ProgressBar.close_progress()})},fail:function(e){ProgressBar.close_progress(),void 0!==window.android?isMobile.Android()&&window.android.showToast(e.msg,"short","center"):alert(e.msg)}})}}),Activity.onCreate(),Activity.onBackPressed(function(e){app.log("이전"+e+"/ 현재 : "+UrlUtil.current_id),"family"==e&&navigator.notification.confirm(app.lang.i_exit_app,function(e){"1"==e||"2"==e&&(void 0!==window.android||window.webkit&&window.webkit.messageHandlers)&&isMobile.Android()&&window.android.closeApp()},"",app.lang.alert_button)}),Activity.setTouchSwipe({target:"#rightside, #right, #bottom",gesture:"right",threshold:100},function(){history.go(-1)}),Handler.post(function(){ProgressBar.close_progress()},200)}function setSharedPreferences(){if(void 0!==window.android||window.webkit&&window.webkit.messageHandlers.setSharedPreferences)if(isMobile.Android()){var e=JSON.stringify(userinfo);window.android.setSharedPreferences(e,"callbackSetSharedPreferences")}else{var i={callback:"callbackSetSharedPreferences"};_.extend(i,userinfo),webkit.messageHandlers.setSharedPreferences.postMessage(JSON.stringify(i))}}function callbackSetSharedPreferences(e){ProgressBar.close_progress(),app.go_url("index.html")}function callbackGetSharedPreferences(e){if(e&&""!=e){var i=$.parseJSON(e);_.isUndefined(i.userid)||(userinfo.usertoken=i.usertoken,userinfo.name=i.name,userinfo.fid=i.fid,userinfo.userid=i.userid,device_info.lang=i.lang,device_info.fcm_token=i.fcm_token,device_info.os_type=i.os_type,Activity.onCreateView())}}function onDeviceReady(){console.log("onDeviceReady"),void 0!==window.android&&screen.orientation.lock("portrait")}var http_referer="login.html",device_info={fcm_token:"",os_type:"",lang:""},userinfo={usertoken:"",name:"",userid:"",fid:"",authtoken:"",nickname:"",profile_image:""};void 0!==window.android&&document.addEventListener("deviceready",onDeviceReady,!1);